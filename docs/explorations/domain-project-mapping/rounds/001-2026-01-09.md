# Round 1 - 2026-01-09

Based on my analysis of the codebase, I've identified several issues and have clarifying questions.

## 1. Retroactive Domain Assignment

The core issue I found: When you add a domain mapping (e.g., `github.com` -> "Work Project"), it only applies to **future** sessions. Sessions that were already recorded before you created the mapping won't have the project assigned.

**Do you want the system to retroactively update existing sessions when you add a new domain mapping?**

Options:
- Yes, update all existing sessions matching the domain
- Yes, but only for sessions in the last N days (specify N)
- No, only apply to new sessions going forward

**Your answer:**
- Yes, update all existing sessions matching the domain


---

## 2. Subdomain Matching

Currently the system does exact domain matching. For example, if you map `github.com`, sessions with `docs.github.com` or `api.github.com` won't match.

**Should subdomain matching be supported?**

Options:
- Yes, `github.com` should match `*.github.com` as well
- No, keep exact matching (user can add subdomains separately)
- Both: Add option to choose "include subdomains" per domain mapping

**Your answer:**
- No, keep exact matching (user can add subdomains separately)


---

## 3. URL Parsing Edge Cases

When cleaning URLs to extract domains, there are some edge cases:

**How should these be handled?**

| Input | Option A (strict) | Option B (lenient) |
|-------|-------------------|-------------------|
| `https://github.com/path` | `github.com` | `github.com` |
| `github.com/path` | `github.com` | `github.com` |
| `www.github.com` | `www.github.com` | `github.com` (strip www) |
| `mail.google.com` | `mail.google.com` | `mail.google.com` |
| `invalid-not-a-url` | Keep as-is | Keep as-is |

**Which approach do you prefer?**
- Option A: Strict (preserve www and subdomains exactly as extracted)
- Option B: Lenient (strip common prefixes like www.)

**Your answer:**
Option A: Strict

---

## 4. Duplicate Domain Handling

Currently a domain can only be mapped to ONE project. If you try to add `github.com` to Project A when it's already mapped to Project B, it fails.

**What should happen when adding a domain that's already mapped?**

Options:
- Error message (current behavior)
- Move the domain to the new project (with warning)
- Show which project already has it and ask to confirm

**Your answer:**
Error message

---

## 5. Timeline Visibility Confirmation

I checked the timeline implementation - it already supports showing project colors. The issue is that sessions need `project_id` set. Once we fix the retroactive assignment, the timeline should display correctly.

**Is there any specific timeline behavior you want that isn't just "show project color for assigned sessions"?**

Options:
- Just show project colors (already implemented, needs data fixed)
- Something else (please describe)

**Your answer:**
Just show project colors 

---
